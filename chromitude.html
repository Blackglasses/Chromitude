<!DOCTYPE html>
<script src="/oauth2/oauth2.js"></script>
<script src="settings.js"></script>
<script>

var googleAuth = new OAuth2('google',{
	client_id: settings.consumer_key,
	client_secret: settings.consumer_secret,
	api_scope: 'https://www.googleapis.com/auth/latitude.current.best https://maps.googleapis.com/maps/api/place/'
});

var clientSettings = {
	get: function(setting)
	{
		return localStorage[setting];
	},
	put: function(setting,value,ifnotexists)
	{
		if(!(ifnotexists && this.exists(setting)))
			localStorage[setting] = value;
		return localStorage[setting];
	},
	exists: function(setting)
	{
		if(localStorage[setting] == undefined) return false;
		else return true;
	}
	// Defaults
	this.put("state","on",true);
	if(!this.exists("watchLoc") || this.get("watchLoc") == "on")
		this.put("watch_location","on",true);
	else
		this.put("watch_location","off",true);
	localStorage.removeItem("watchLoc"); // Renamed to watch_location.  Cleanup from v1.
	this.put("only_update_when_active","on",true);
	this.put("show_notification","off",true);
	this.put("update_int","5",true);
	this.put("update_type","m",true);
	this.put("has_shown_donate","false",true);
	this.put("use_fixed_location","off",true);
	this.put("has_alerted_v2","false",true);
};

googleAuth.authorize(function()
{
	
});

function updatePosition(pos)
{
	var location =
	{
		"data":
		{
			"kind": "latitude#location",
			"timestampMs": pos.timestamp,
			"latitude": pos.coords.latitude,
			"longitude": pos.coords.longitude,
			"accuracy": pos.coords.accuracy,
			"speed": pos.coords.speed,
			"altitude": pos.coords.altitude,
			"altitudeAccuracy": pos.coords.altitudeAccuracy
		}
	};
}

</script>